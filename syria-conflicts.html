<!DOCTYPE html>
<!-- Asifah Analytics - Syria Conflict Tracker v2.8.2 - Last updated: Feb 14, 2025 -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Syria Conflict Tracker | Asifah Analytics v2.8.2</title>
    
    <!-- Favicon using Asifah Analytics logo -->
    <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/SassAndSweet/asifah-analytics/main/Asifah_Analytics_1_25_26_V1_LOGO.png">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* CSS Variables for Light/Dark Mode */
        :root {
            /* Light Mode Colors (matching landing page) */
            --bg-color: #f5f5f5;
            --container-bg: #ffffff;
            --card-bg: #ffffff;
            --card-border: #e1e8ed;
            --text-primary: #2c3e50;
            --text-secondary: #7f8c8d;
            --text-muted: #95a5a6;
            --header-gradient-start: #1e3a5f;
            --header-gradient-end: #2c5282;
            --header-text: #ffffff;
            --metric-bg: #ffffff;
            --metric-hover-shadow: rgba(0,0,0,0.15);
            --article-bg: #f8f9fa;
            --article-hover: #e8f4f8;
            --watermark-opacity: 0.03;
            --loading-overlay-bg: rgba(245, 245, 245, 0.98);
            --loading-spinner-bg: rgba(192, 132, 252, 0.2);
            --syria-accent: #c084fc;
            --unhcr-blue: #0072bc;
        }

        [data-theme="dark"] {
            /* Dark Mode Colors */
            --bg-color: #1a1a1a;
            --container-bg: #2d2d2d;
            --card-bg: #2d2d2d;
            --card-border: #404040;
            --text-primary: #e0e0e0;
            --text-secondary: #b0b0b0;
            --text-muted: #808080;
            --header-gradient-start: #1e3a5f;
            --header-gradient-end: #2c5282;
            --header-text: #ffffff;
            --metric-bg: #2d2d2d;
            --metric-hover-shadow: rgba(255,255,255,0.1);
            --article-bg: #353535;
            --article-hover: #404040;
            --watermark-opacity: 0.02;
            --loading-overlay-bg: rgba(26, 26, 26, 0.98);
            --loading-spinner-bg: rgba(192, 132, 252, 0.3);
            --syria-accent: #c084fc;
            --unhcr-blue: #0072bc;
        }

        body {
            font-family: 'Times New Roman', Times, serif;
            font-size: 14px;
            background-color: var(--bg-color);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 20px;
            transition: background-color 0.3s ease, color 0.3s ease;
            position: relative;
        }

        /* Watermark Background */
        body::before {
            content: '';
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 800px;
            height: 800px;
            background-image: url('https://raw.githubusercontent.com/SassAndSweet/asifah-analytics/main/Asifah_Analytics_1_25_26_V1_LOGO.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            opacity: var(--watermark-opacity);
            z-index: 0;
            pointer-events: none;
            user-select: none;
        }

        /* Loading Overlay Styles */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--loading-overlay-bg);
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }

        .loading-overlay.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid var(--loading-spinner-bg);
            border-top-color: var(--syria-accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 30px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-status {
            text-align: center;
            max-width: 500px;
            padding: 0 20px;
        }

        .loading-title {
            font-size: 24px;
            font-weight: bold;
            color: var(--syria-accent);
            margin-bottom: 20px;
            letter-spacing: 1px;
        }

        .loading-steps {
            margin-top: 20px;
        }

        .loading-step {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            padding: 12px;
            font-size: 15px;
            color: var(--text-secondary);
            transition: all 0.3s ease;
        }

        .loading-step.active {
            color: var(--syria-accent);
            font-weight: bold;
        }

        .loading-step.complete {
            color: #4ade80;
        }

        .step-icon {
            font-size: 18px;
            min-width: 20px;
        }

        .loading-progress {
            margin-top: 25px;
            font-size: 13px;
            color: var(--text-secondary);
            font-style: italic;
        }

        .loading-error {
            color: #f87171;
            font-size: 16px;
            margin-top: 20px;
            padding: 15px;
            background: rgba(248, 113, 113, 0.1);
            border: 1px solid rgba(248, 113, 113, 0.3);
            border-radius: 8px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        header {
            background: linear-gradient(135deg, var(--header-gradient-start) 0%, var(--header-gradient-end) 100%);
            color: var(--header-text);
            padding: 35px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
            position: relative;
            display: flex;
            align-items: center;
            gap: 30px;
        }

        .header-logo {
            width: 80px;
            height: 80px;
            flex-shrink: 0;
            border-radius: 50%;
            margin-top: 48px;
        }

        .header-content {
            flex: 1;
            text-align: center;
        }

        h1 {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 10px;
            letter-spacing: 2px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .subtitle {
            font-size: 16px;
            font-weight: normal;
            opacity: 0.95;
            letter-spacing: 0.5px;
        }

        /* Controls container on the right */
        .header-controls {
            position: absolute;
            top: 35px;
            right: 35px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
        }

        [dir="rtl"] .header-controls {
            right: auto;
            left: 35px;
        }

        /* Language Switcher */
        .language-switcher {
            display: flex;
            gap: 8px;
            background: rgba(255,255,255,0.15);
            padding: 8px 12px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }

        /* Theme Toggle */
        .theme-toggle {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            background: rgba(255,255,255,0.15);
            padding: 8px 12px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }

        .theme-toggle-label {
            font-size: 11px;
            color: rgba(255,255,255,0.9);
            margin-right: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            white-space: nowrap;
        }

        .theme-toggle-switch {
            position: relative;
            width: 50px;
            height: 26px;
            background: rgba(255,255,255,0.2);
            border-radius: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid rgba(255,255,255,0.3);
        }

        .theme-toggle-switch:hover {
            background: rgba(255,255,255,0.3);
            border-color: rgba(255,255,255,0.5);
        }

        .theme-toggle-slider {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 18px;
            height: 18px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
        }

        .theme-toggle-slider::before {
            content: '‚òÄÔ∏è';
        }

        [data-theme="dark"] .theme-toggle-slider {
            transform: translateX(24px);
        }

        [data-theme="dark"] .theme-toggle-slider::before {
            content: 'üåô';
        }

        .lang-btn {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 6px 14px;
            font-family: 'Times New Roman', Times, serif;
            font-size: 14px;
            font-weight: bold;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .lang-btn:hover {
            background: rgba(255,255,255,0.3);
            border-color: rgba(255,255,255,0.5);
        }

        .lang-btn.active {
            background: white;
            color: #1e3a5f;
            border-color: white;
        }

        .back-link {
            display: inline-block;
            position: absolute;
            top: 20px;
            left: 20px;
            margin: 0;
            padding: 12px 24px;
            background: rgba(255,255,255,0.2);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            border: 2px solid rgba(255,255,255,0.3);
            transition: all 0.2s ease;
            font-size: 14px;
            font-weight: bold;
        }

        .back-link:hover {
            background: rgba(255,255,255,0.3);
            border-color: rgba(255,255,255,0.5);
        }

        .error-banner {
            background: rgba(255, 107, 107, 0.2);
            border: 2px solid #ff6b6b;
            color: #ff6b6b;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
            font-size: 14px;
            display: none;
        }

        .error-banner.show {
            display: block;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: var(--metric-bg);
            border: 2px solid var(--card-border);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: all 0.3s;
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px var(--metric-hover-shadow);
        }

        .metric-icon {
            font-size: 36px;
            margin-bottom: 10px;
        }

        .metric-number {
            font-size: 42px;
            font-weight: bold;
            color: var(--syria-accent);
            margin-bottom: 5px;
        }

        .metric-label {
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-secondary);
        }

        .estimated-badge {
            display: inline-block;
            background: #a855f7;
            color: white;
            font-size: 9px;
            padding: 3px 8px;
            border-radius: 3px;
            margin-top: 8px;
        }

        /* Enhanced displacement card styles */
        .displacement-stats {
            margin-top: 15px;
            padding: 12px;
            background: rgba(192, 132, 252, 0.05);
            border-radius: 8px;
            text-align: left;
        }

        .displacement-stat-item {
            display: flex;
            justify-content: space-between;
            padding: 6px 0;
            font-size: 12px;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--card-border);
        }

        .displacement-stat-item:last-child {
            border-bottom: none;
        }

        .displacement-stat-label {
            font-weight: bold;
        }

        .displacement-stat-value {
            color: var(--syria-accent);
        }

        .humanitarian-sources {
            margin-top: 15px;
            padding-top: 12px;
            border-top: 2px solid var(--card-border);
        }

        .humanitarian-sources-title {
            font-size: 10px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 10px;
            text-align: left;
        }

        .humanitarian-link {
            display: block;
            padding: 8px 10px;
            margin-bottom: 6px;
            background: rgba(0, 114, 188, 0.1);
            border-left: 3px solid var(--unhcr-blue);
            border-radius: 4px;
            text-decoration: none;
            font-size: 11px;
            color: var(--unhcr-blue);
            transition: all 0.2s ease;
            text-align: left;
        }

        .humanitarian-link:hover {
            background: rgba(0, 114, 188, 0.2);
            padding-left: 15px;
        }

        .humanitarian-link-icon {
            margin-right: 6px;
        }

        .locations-list {
            margin-top: 15px;
            text-align: left;
            max-height: 150px;
            overflow-y: auto;
        }

        .location-item {
            padding: 5px 0;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .source-citations {
            margin-top: 15px;
            padding-top: 10px;
            border-top: 1px solid var(--card-border);
            text-align: left;
            max-height: 200px;
            overflow-y: auto;
        }

        .source-citations-title {
            font-size: 10px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .citation-item {
            font-size: 11px;
            margin-bottom: 6px;
            padding-left: 8px;
            border-left: 2px solid rgba(168, 85, 247, 0.5);
        }

        .citation-item a {
            color: var(--syria-accent);
            text-decoration: none;
        }

        .citation-item a:hover {
            text-decoration: underline;
        }

        /* Knowledge Library Styles */
        .knowledge-library {
            background: var(--container-bg);
            border: 2px solid var(--card-border);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: background 0.3s ease, border-color 0.3s ease;
        }

        .knowledge-library h2 {
            font-size: 24px;
            margin-bottom: 20px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .library-icon {
            font-size: 28px;
        }

        .knowledge-categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .knowledge-card {
            background: var(--card-bg);
            border: 2px solid var(--card-border);
            border-radius: 10px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .knowledge-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 16px var(--metric-hover-shadow);
        }

        .knowledge-header {
            background: linear-gradient(135deg, rgba(192, 132, 252, 0.1) 0%, rgba(168, 85, 247, 0.1) 100%);
            padding: 18px 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s ease;
        }

        .knowledge-header:hover {
            background: linear-gradient(135deg, rgba(192, 132, 252, 0.15) 0%, rgba(168, 85, 247, 0.15) 100%);
        }

        .knowledge-header-title {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 16px;
            font-weight: bold;
            color: var(--text-primary);
        }

        .category-icon {
            font-size: 22px;
        }

        .collapse-icon {
            font-size: 20px;
            color: var(--syria-accent);
            transition: transform 0.3s ease;
        }

        .knowledge-card.collapsed .collapse-icon {
            transform: rotate(-90deg);
        }

        .knowledge-content {
            padding: 20px;
            max-height: 400px;
            overflow-y: auto;
            transition: max-height 0.3s ease, padding 0.3s ease;
        }

        .knowledge-card.collapsed .knowledge-content {
            max-height: 0;
            padding: 0 20px;
            overflow: hidden;
        }

        .knowledge-content p {
            font-size: 13px;
            line-height: 1.6;
            color: var(--text-secondary);
            margin-bottom: 12px;
        }

        .knowledge-content ul {
            margin-left: 20px;
            margin-bottom: 12px;
        }

        .knowledge-content li {
            font-size: 13px;
            line-height: 1.6;
            color: var(--text-secondary);
            margin-bottom: 6px;
        }

        .knowledge-content strong {
            color: var(--text-primary);
        }

        .pdf-link-section {
            margin-top: 20px;
            padding: 15px;
            background: rgba(192, 132, 252, 0.08);
            border-left: 4px solid var(--syria-accent);
            border-radius: 6px;
        }

        .pdf-link-title {
            font-size: 12px;
            font-weight: bold;
            color: var(--text-primary);
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .pdf-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            background: var(--syria-accent);
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-size: 13px;
            font-weight: bold;
            transition: all 0.3s ease;
            margin-top: 8px;
        }

        .pdf-link:hover {
            background: #a855f7;
            transform: translateX(3px);
            box-shadow: 0 4px 12px rgba(192, 132, 252, 0.3);
        }

        .pdf-icon {
            font-size: 16px;
        }

        .open-source-disclaimer {
            font-size: 11px;
            color: var(--text-muted);
            font-style: italic;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid var(--card-border);
        }

        .news-section {
            background: var(--container-bg);
            border: 2px solid var(--card-border);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: background 0.3s ease, border-color 0.3s ease;
        }

        .news-section h2 {
            font-size: 24px;
            margin-bottom: 20px;
            color: var(--text-primary);
        }

        .language-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--card-border);
            padding-bottom: 10px;
            flex-wrap: wrap;
        }

        .language-tabs button {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-family: 'Times New Roman', Times, serif;
            font-size: 16px;
            padding: 8px 16px;
            cursor: pointer;
            transition: all 0.3s;
            border-bottom: 2px solid transparent;
            margin-bottom: -12px;
        }

        .language-tabs button:hover {
            color: var(--text-primary);
        }

        .language-tabs button.active {
            color: var(--syria-accent);
            border-bottom-color: var(--syria-accent);
        }

        .articles-container {
            max-height: 600px;
            overflow-y: auto;
        }

        .article {
            background: var(--article-bg);
            border: 1px solid var(--card-border);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s;
        }

        .article:hover {
            background: var(--article-hover);
        }

        .article-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .article-title a {
            color: var(--syria-accent);
            text-decoration: none;
        }

        .article-title a:hover {
            text-decoration: underline;
        }

        .article-description {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 12px;
        }

        .article-meta {
            font-size: 12px;
            color: var(--text-muted);
            display: flex;
            gap: 15px;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: var(--syria-accent);
        }

        footer {
            background: var(--container-bg);
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            border: 2px solid var(--card-border);
            font-size: 12px;
            text-align: center;
            color: var(--text-secondary);
            margin-top: 30px;
            transition: background 0.3s ease, border-color 0.3s ease;
        }

        .support-footer {
            margin-top: 25px;
            padding: 15px 20px;
            background: rgba(192, 132, 252, 0.1);
            border: 1px solid rgba(192, 132, 252, 0.2);
            border-radius: 8px;
        }

        .support-footer a {
            color: var(--syria-accent);
            text-decoration: none;
            font-weight: bold;
            transition: all 0.2s ease;
        }

        .support-footer a:hover {
            color: #d8b4fe;
            text-decoration: underline;
        }

        .copyright-footer {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--card-border);
            font-size: 11px;
        }

        .articles-container::-webkit-scrollbar,
        .knowledge-content::-webkit-scrollbar {
            width: 8px;
        }

        .articles-container::-webkit-scrollbar-track,
        .knowledge-content::-webkit-scrollbar-track {
            background: var(--article-bg);
            border-radius: 4px;
        }

        .articles-container::-webkit-scrollbar-thumb,
        .knowledge-content::-webkit-scrollbar-thumb {
            background: var(--card-border);
            border-radius: 4px;
        }

        .articles-container::-webkit-scrollbar-thumb:hover,
        .knowledge-content::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }

        [dir="rtl"] {
            direction: rtl;
            text-align: right;
        }

        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 20px;
                padding: 25px 20px;
            }
            
            .header-logo {
                width: 60px;
                height: 60px;
            }
            
            .header-content {
                text-align: center;
            }
            
            .header-controls {
                position: static;
                align-items: center;
            }
            
            h1 {
                font-size: 24px;
            }
            
            .back-link {
                position: static;
                display: block;
                width: fit-content;
                margin: 0 auto 15px;
            }

            .knowledge-categories {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-status">
            <div class="loading-title">Loading Syria Conflict Data</div>
            <div class="loading-steps" id="loadingSteps">
                <div class="loading-step active" id="step1">
                    <span class="step-icon">‚è≥</span>
                    <span>Fetching Syria Direct reports...</span>
                </div>
                <div class="loading-step" id="step2">
                    <span class="step-icon">‚è≥</span>
                    <span>Querying SOHR data...</span>
                </div>
                <div class="loading-step" id="step3">
                    <span class="step-icon">‚è≥</span>
                    <span>Extracting casualty statistics...</span>
                </div>
                <div class="loading-step" id="step4">
                    <span class="step-icon">‚è≥</span>
                    <span>Mapping factional clashes...</span>
                </div>
                <div class="loading-step" id="step5">
                    <span class="step-icon">‚è≥</span>
                    <span>Rendering conflict dashboard...</span>
                </div>
            </div>
            <div class="loading-progress" id="loadingProgress">
                This may take 20-40 seconds...
            </div>
            <div class="loading-error" id="loadingError" style="display: none;">
                ‚ö†Ô∏è Loading is taking longer than expected. Please wait or refresh the page.
            </div>
        </div>
    </div>

    <div class="container">
        <header>
            <a href="index.html" class="back-link" data-i18n="backLink">‚Üê Back to Dashboard</a>
            
            <img src="https://raw.githubusercontent.com/SassAndSweet/asifah-analytics/main/Asifah_Analytics_1_25_26_V1_LOGO.png" alt="Asifah Analytics Logo" class="header-logo">
            
            <div class="header-content">
                <h1 data-i18n="pageTitle">üá∏üáæ SYRIA CONFLICT TRACKER</h1>
                <div class="subtitle" data-i18n="pageSubtitle">Real-time monitoring of post-Assad factional violence and displacement</div>
            </div>
            
            <div class="header-controls">
                <div class="language-switcher">
                    <button class="lang-btn active" onclick="switchLanguage('en')">EN</button>
                    <button class="lang-btn" onclick="switchLanguage('he')">◊¢◊ë</button>
                    <button class="lang-btn" onclick="switchLanguage('ar')">ÿπ</button>
                    <button class="lang-btn" onclick="switchLanguage('fa')">ŸÅÿß</button>
                </div>
                
                <div class="theme-toggle">
                    <span class="theme-toggle-label" data-i18n="themeToggle">Toggle: Light - Dark</span>
                    <div class="theme-toggle-switch" onclick="toggleTheme()">
                        <div class="theme-toggle-slider"></div>
                    </div>
                </div>
            </div>
        </header>

        <div class="error-banner" id="errorBanner"></div>

        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-icon">‚ò†Ô∏è</div>
                <div class="metric-number" id="deathCount">--</div>
                <div class="metric-label" data-i18n="deathsLabel">Deaths Reported</div>
                <div class="estimated-badge" data-i18n="estimated">ESTIMATED</div>
                <div class="source-citations" id="deathSources"></div>
            </div>
            
            <div class="metric-card">
                <div class="metric-icon">üè†</div>
                <div class="metric-number" id="displacedCount">--</div>
                <div class="metric-label" data-i18n="displacedLabel">Displaced Persons</div>
                <div class="estimated-badge" data-i18n="estimated">ESTIMATED</div>
                
                <!-- Enhanced displacement breakdown -->
                <div class="displacement-stats" id="displacementStats">
                    <div class="displacement-stat-item">
                        <span class="displacement-stat-label">IDPs (Internal):</span>
                        <span class="displacement-stat-value" id="idpCount">--</span>
                    </div>
                    <div class="displacement-stat-item">
                        <span class="displacement-stat-label">Camp Populations:</span>
                        <span class="displacement-stat-value" id="campCount">--</span>
                    </div>
                    <div class="displacement-stat-item">
                        <span class="displacement-stat-label">Recent Movement:</span>
                        <span class="displacement-stat-value" id="recentDisplacement">--</span>
                    </div>
                </div>
                
                <!-- Humanitarian organization links -->
                <div class="humanitarian-sources">
                    <div class="humanitarian-sources-title">Humanitarian Sources:</div>
                    <a href="https://data.unhcr.org/en/country/syr" target="_blank" class="humanitarian-link">
                        <span class="humanitarian-link-icon">üîó</span>
                        UNHCR Syria Portal
                    </a>
                    <a href="https://www.acaps.org/countries/syria" target="_blank" class="humanitarian-link">
                        <span class="humanitarian-link-icon">üîó</span>
                        ACAPS Syria Analysis
                    </a>
                    <a href="https://apnews.com/hub/syria" target="_blank" class="humanitarian-link">
                        <span class="humanitarian-link-icon">üîó</span>
                        AP News - Al-Hol Camp
                    </a>
                    <a href="https://reliefweb.int/country/syr" target="_blank" class="humanitarian-link">
                        <span class="humanitarian-link-icon">üîó</span>
                        ReliefWeb Syria
                    </a>
                </div>
            </div>
            
            <div class="metric-card">
                <div class="metric-icon">‚öîÔ∏è</div>
                <div class="metric-number" id="clashCount">--</div>
                <div class="metric-label" data-i18n="clashesLabel">Factional Clashes</div>
                <div class="estimated-badge" data-i18n="estimated">ESTIMATED</div>
                <div class="source-citations" id="clashSources"></div>
            </div>
            
            <div class="metric-card">
                <div class="metric-icon">üó∫Ô∏è</div>
                <div class="metric-number" id="factionCount">--</div>
                <div class="metric-label" data-i18n="factionsLabel">Active Factions</div>
                <div class="estimated-badge" data-i18n="estimated">ESTIMATED</div>
                <div id="factionList" style="margin-top:10px; font-size:11px; color:var(--syria-accent);"></div>
            </div>
            
            <div class="metric-card">
                <div class="metric-icon">üìç</div>
                <div class="metric-label" data-i18n="locationsLabel">Clash Locations</div>
                <div class="locations-list" id="locationsList"></div>
            </div>
        </div>

        <!-- Knowledge Library Section -->
        <div class="knowledge-library">
            <h2>
                <span class="library-icon">üìö</span>
                <span data-i18n="knowledgeLibraryTitle">Knowledge Library</span>
            </h2>
            <p class="open-source-disclaimer">
                Note: Background information is compiled from open-source research and analysis. For detailed assessments, see linked one-pager documents below.
            </p>
            
            <div class="knowledge-categories">
                <!-- Security & Conflict -->
                <div class="knowledge-card" id="card-security">
                    <div class="knowledge-header" onclick="toggleKnowledgeCard('security')">
                        <div class="knowledge-header-title">
                            <span class="category-icon">‚öîÔ∏è</span>
                            <span data-i18n="catSecurity">Security & Conflict</span>
                        </div>
                        <span class="collapse-icon">‚ñº</span>
                    </div>
                    <div class="knowledge-content">
                        <p><strong>Post-Assad Security Landscape:</strong> Following the fall of the Assad regime in late 2024, Syria has fragmented into multiple zones of control with competing armed factions vying for territorial dominance.</p>
                        
                        <p><strong>Major Armed Groups:</strong></p>
                        <ul>
                            <li><strong>Syrian National Army (SNA):</strong> Turkish-backed opposition forces controlling parts of northern Syria</li>
                            <li><strong>Syrian Democratic Forces (SDF):</strong> Kurdish-led coalition controlling northeastern Syria</li>
                            <li><strong>Hayat Tahrir al-Sham (HTS):</strong> Islamist group controlling Idlib and surrounding areas</li>
                            <li><strong>ISIS Remnants:</strong> Sleeper cells active in desert regions and displacement camps</li>
                            <li><strong>Local Militias:</strong> Various tribal and regional armed groups</li>
                        </ul>

                        <p><strong>Primary Flashpoints:</strong> Clashes frequently occur along factional boundaries, particularly in Aleppo countryside, Deir ez-Zor, and areas surrounding displacement camps like al-Hol.</p>

                        <p><strong>Violence Patterns:</strong> Post-regime violence includes inter-factional fighting, revenge killings, ISIS attacks on security forces, and tribal conflicts over resource control.</p>
                    </div>
                </div>

                <!-- Economic & Financial Stability -->
                <div class="knowledge-card" id="card-economic">
                    <div class="knowledge-header" onclick="toggleKnowledgeCard('economic')">
                        <div class="knowledge-header-title">
                            <span class="category-icon">üí∞</span>
                            <span data-i18n="catEconomic">Economic & Financial Stability</span>
                        </div>
                        <span class="collapse-icon">‚ñº</span>
                    </div>
                    <div class="knowledge-content">
                        <p><strong>Economic Collapse:</strong> Syria's economy has contracted by more than 60% since 2011, with currency devaluation, hyperinflation, and widespread poverty.</p>
                        
                        <p><strong>Resource Control:</strong></p>
                        <ul>
                            <li><strong>Oil and gas:</strong> Primary fields in SDF-controlled northeast; limited production and smuggling networks</li>
                            <li><strong>Agriculture:</strong> Key breadbasket regions divided among factions; drought and infrastructure damage reduce output</li>
                            <li><strong>Trade routes:</strong> Border crossings and supply routes controlled by various armed groups</li>
                        </ul>

                        <p><strong>Currency Crisis:</strong> Syrian pound has lost over 95% of pre-war value; multiple exchange rates; dollarization in some regions; reliance on remittances.</p>

                        <p><strong>Economic Activity:</strong> Formal economy largely collapsed; informal and black markets dominate; smuggling networks; war economy sustains armed factions; reconstruction minimal due to sanctions and insecurity.</p>

                        <p><strong>Sanctions Impact:</strong> US and EU sanctions restrict reconstruction investment, complicate aid delivery, and limit banking access, though humanitarian exemptions exist.</p>

                        <!-- PDF Resource Link -->
                        <div class="pdf-link-section">
                            <div class="pdf-link-title">üìÑ Detailed Analysis:</div>
                            <a href="https://raw.githubusercontent.com/SassAndSweet/asifah-analytics/main/Captagon_One_Pager.pdf" target="_blank" class="pdf-link">
                                <span class="pdf-icon">üìë</span>
                                <span>Captagon Trade & Syrian Economy One-Pager</span>
                            </a>
                            <p class="open-source-disclaimer">Comprehensive assessment of Syria's captagon production, trafficking networks, and economic impact.</p>
                        </div>
                    </div>
                </div>

                <!-- Governance & Political Dynamics -->
                <div class="knowledge-card" id="card-governance">
                    <div class="knowledge-header" onclick="toggleKnowledgeCard('governance')">
                        <div class="knowledge-header-title">
                            <span class="category-icon">üèõÔ∏è</span>
                            <span data-i18n="catGovernance">Governance & Political Dynamics</span>
                        </div>
                        <span class="collapse-icon">‚ñº</span>
                    </div>
                    <div class="knowledge-content">
                        <p><strong>Governance Vacuum:</strong> The collapse of centralized Assad regime control has created a patchwork of competing governance structures, with no unified authority emerging.</p>
                        
                        <p><strong>De Facto Administrations:</strong></p>
                        <ul>
                            <li><strong>Autonomous Administration of North and East Syria (AANES):</strong> Kurdish-led self-governance in northeastern regions</li>
                            <li><strong>Syrian Salvation Government:</strong> HTS-controlled administration in Idlib</li>
                            <li><strong>Turkish-backed councils:</strong> Local governance structures in SNA-controlled areas</li>
                            <li><strong>Tribal councils:</strong> Traditional governance in eastern and southern regions</li>
                        </ul>

                        <p><strong>Political Transition Challenges:</strong> Efforts at political transition face obstacles including factional competition, external interference, sectarian divisions, and absence of inclusive representation mechanisms.</p>

                        <p><strong>International Engagement:</strong> UN-led Geneva process remains stalled; regional powers pursue competing political visions; reconstruction aid conditioned on political reforms.</p>
                    </div>
                </div>

                <!-- Regional & External Influence -->
                <div class="knowledge-card" id="card-regional">
                    <div class="knowledge-header" onclick="toggleKnowledgeCard('regional')">
                        <div class="knowledge-header-title">
                            <span class="category-icon">üåç</span>
                            <span data-i18n="catRegional">Regional & External Influence</span>
                        </div>
                        <span class="collapse-icon">‚ñº</span>
                    </div>
                    <div class="knowledge-content">
                        <p><strong>External Involvement:</strong> Multiple regional and international actors maintain military presence and political influence in Syria's post-Assad landscape.</p>
                        
                        <p><strong>Turkey:</strong></p>
                        <ul>
                            <li>Controls northern buffer zones through proxy forces (SNA)</li>
                            <li>Primary objective: prevent Kurdish autonomy along border</li>
                            <li>Hosts 3.6+ million Syrian refugees</li>
                            <li>Conducts periodic military operations against SDF</li>
                        </ul>

                        <p><strong>Iran:</strong></p>
                        <ul>
                            <li>Maintains limited military presence despite Assad regime collapse</li>
                            <li>Supports aligned militias in strategic areas</li>
                            <li>Interested in preserving land corridor to Lebanon</li>
                            <li>Faces resource constraints limiting engagement</li>
                        </ul>

                        <p><strong>Russia:</strong></p>
                        <ul>
                            <li>Maintains military bases at Tartus and Hmeimim</li>
                            <li>Reduced military footprint post-Assad</li>
                            <li>Focus on preserving strategic coastal access</li>
                            <li>Limited appetite for large-scale intervention</li>
                        </ul>

                        <p><strong>United States:</strong></p>
                        <ul>
                            <li>Partners with SDF in counter-ISIS operations</li>
                            <li>Maintains approximately 900 troops in northeast</li>
                            <li>Controls strategic oil fields in partnership with SDF</li>
                            <li>Enforces sanctions regime</li>
                        </ul>

                        <p><strong>Israel:</strong></p>
                        <ul>
                            <li>Conducts periodic airstrikes against Iranian positions</li>
                            <li>Occupies Golan Heights buffer zone</li>
                            <li>Primary concern: preventing Iranian weapons transfers to Hezbollah</li>
                        </ul>

                        <p><strong>Gulf States:</strong> Gradually re-engaging diplomatically; Arab League readmitted Syria in 2023; limited reconstruction investment pending political settlement.</p>
                    </div>
                </div>

                <!-- Structural Risk Indicators -->
                <div class="knowledge-card" id="card-structural">
                    <div class="knowledge-header" onclick="toggleKnowledgeCard('structural')">
                        <div class="knowledge-header-title">
                            <span class="category-icon">üìà</span>
                            <span data-i18n="catStructural">Structural Risk Indicators</span>
                        </div>
                        <span class="collapse-icon">‚ñº</span>
                    </div>
                    <div class="knowledge-content">
                        <p><strong>Displacement Crisis:</strong> Syria faces one of the world's largest displacement crises with millions of internally displaced persons (IDPs) and refugees in neighboring countries.</p>
                        
                        <p><strong>IDP Demographics:</strong></p>
                        <ul>
                            <li><strong>Camp populations:</strong> Approximately 1 million people in formal camps including al-Hol, Roj, and northern settlements</li>
                            <li><strong>Informal settlements:</strong> Additional millions in makeshift camps and urban displacement</li>
                            <li><strong>Recent displacement:</strong> Post-Assad factional fighting has triggered new waves of internal displacement</li>
                        </ul>

                        <p><strong>Humanitarian Access:</strong> Aid delivery is hampered by factional control of territory, cross-border restrictions, damaged infrastructure, and security threats to aid workers.</p>

                        <p><strong>Critical Needs:</strong> Food insecurity affects majority of population; medical services severely degraded; water and sanitation infrastructure damaged; education systems disrupted; protection concerns especially for women and children.</p>

                        <p><strong>Infrastructure Collapse:</strong> Years of conflict have devastated critical infrastructure including power grids, water systems, roads, hospitals, and schools. Reconstruction is hampered by lack of funding, ongoing insecurity, and international sanctions.</p>

                        <p><strong>Demographic Shifts:</strong> War-induced population movements have altered sectarian and ethnic balances in key regions, creating new tensions and complicating future reconciliation efforts.</p>

                        <p><strong>Institutional Decay:</strong> State institutions have largely collapsed or become hollowed out, with limited capacity to provide basic services, enforce law, or manage reconstruction.</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="news-section">
            <h2 data-i18n="newsTitle">News Coverage</h2>
            
            <div class="language-tabs">
                <button onclick="showArticles('syria_direct', event)" class="active" data-i18n="tabSyriaDirect">Syria Direct (--)</button>
                <button onclick="showArticles('sohr', event)" data-i18n="tabSOHR">SOHR (--)</button>
                <button onclick="showArticles('en', event)" data-i18n="tabEnglish">English (--)</button>
                <button onclick="showArticles('he', event)" data-i18n="tabHebrew">Hebrew (--)</button>
                <button onclick="showArticles('ar', event)" data-i18n="tabArabic">Arabic (--)</button>
                <button onclick="showArticles('fa', event)" data-i18n="tabFarsi">Farsi (--)</button>
                <button onclick="showArticles('reddit', event)" data-i18n="tabReddit">Reddit (--)</button>
            </div>

            <div class="articles-container" id="articles-container">
                <div class="loading">Loading articles...</div>
            </div>
        </div>

        <footer>
            <p><strong>Asifah Analytics v2.8.2 | Syria Conflict Tracker</strong></p>
            <p><strong>Data Sources:</strong> NewsAPI for aggregating news sources, GDELT for Arabic, Hebrew, and Farsi content, Syria Direct and SOHR RSS feeds, Reddit for community intelligence, UNHCR for displacement data, ACAPS for humanitarian analysis, plus other OSINT sources.</p>
            <p><strong>For inquiries, contact:</strong> <a href="mailto:asifahanalytics@gmail.com" style="color: var(--syria-accent); text-decoration: none;">asifahanalytics@gmail.com</a></p>
            <p style="margin-top: 10px; font-size: 11px;">Updated every 30 minutes | Not for operational use</p>
            
            <div class="support-footer">
                <p>
                    If you find Asifah Analytics useful and want to support ongoing development, you can 
                    <a href="https://buymeacoffee.com/asifahanalytics" target="_blank" rel="noopener noreferrer">‚òï buy me a coffee</a>
                </p>
            </div>
            
            <div class="copyright-footer">
                ¬© 2025 RCGG. All Rights Reserved. Proprietary and Confidential.<br>
                Unauthorized use, reproduction, or distribution prohibited.
            </div>
        </footer>
    </div>

    <script>
        const BACKEND_URL = 'https://asifah-backend.onrender.com';
        let conflictData = null;

        // Theme Management
        function initTheme() {
            const savedTheme = localStorage.getItem('asifah-theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
        }

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('asifah-theme', newTheme);
        }

        initTheme();

        // Loading Overlay Management
        let loadingStepIndex = 0;
        let loadingInterval = null;
        let loadingTimeout = null;

        function startLoadingProgress() {
            const steps = ['step1', 'step2', 'step3', 'step4', 'step5'];
            
            loadingInterval = setInterval(() => {
                if (loadingStepIndex < steps.length - 1) {
                    const currentStep = document.getElementById(steps[loadingStepIndex]);
                    if (currentStep) {
                        currentStep.classList.remove('active');
                        currentStep.classList.add('complete');
                        currentStep.querySelector('.step-icon').textContent = '‚úì';
                    }
                    
                    loadingStepIndex++;
                    const nextStep = document.getElementById(steps[loadingStepIndex]);
                    if (nextStep) {
                        nextStep.classList.add('active');
                    }
                }
            }, 8000);
            
            loadingTimeout = setTimeout(() => {
                document.getElementById('loadingError').style.display = 'block';
            }, 60000);
        }

        function hideLoadingOverlay() {
            if (loadingInterval) clearInterval(loadingInterval);
            if (loadingTimeout) clearTimeout(loadingTimeout);
            
            document.querySelectorAll('.loading-step').forEach(step => {
                step.classList.remove('active');
                step.classList.add('complete');
                step.querySelector('.step-icon').textContent = '‚úì';
            });
            
            setTimeout(() => {
                const overlay = document.getElementById('loadingOverlay');
                if (overlay) {
                    overlay.classList.add('hidden');
                }
            }, 500);
        }

        const translations = {
            en: {
                pageTitle: "üá∏üáæ SYRIA CONFLICT TRACKER",
                pageSubtitle: "Real-time monitoring of post-Assad factional violence and displacement",
                backLink: "‚Üê Back to Dashboard",
                themeToggle: "Toggle: Light - Dark",
                deathsLabel: "Deaths Reported",
                displacedLabel: "Displaced Persons",
                clashesLabel: "Factional Clashes",
                factionsLabel: "Active Factions",
                locationsLabel: "Clash Locations",
                estimated: "ESTIMATED",
                knowledgeLibraryTitle: "Knowledge Library",
                catSecurity: "Security & Conflict",
                catEconomic: "Economic & Financial Stability",
                catGovernance: "Governance & Political Dynamics",
                catRegional: "Regional & External Influence",
                catStructural: "Structural Risk Indicators",
                newsTitle: "News Coverage",
                tabSyriaDirect: "Syria Direct",
                tabSOHR: "SOHR",
                tabEnglish: "English",
                tabHebrew: "Hebrew",
                tabArabic: "Arabic",
                tabFarsi: "Farsi",
                tabReddit: "Reddit"
            },
            he: {
                pageTitle: "üá∏üáæ ◊û◊¢◊ß◊ë ◊°◊õ◊°◊ï◊ö ◊ë◊°◊ï◊®◊ô◊î",
                pageSubtitle: "◊†◊ô◊ò◊ï◊® ◊ë◊ñ◊û◊ü ◊ê◊û◊™ ◊©◊ú ◊ê◊ú◊ô◊û◊ï◊™ ◊§◊ú◊í◊ô◊ù ◊ï◊¢◊ß◊ô◊®◊î ◊ú◊ê◊ó◊® ◊ê◊°◊ì",
                backLink: "‚Üí ◊ó◊ñ◊®◊î ◊ú◊ú◊ï◊ó ◊î◊ë◊ß◊®◊î",
                themeToggle: "◊û◊¢◊ë◊®: ◊ë◊î◊ô◊® - ◊õ◊î◊î",
                deathsLabel: "◊î◊®◊ï◊í◊ô◊ù ◊û◊ì◊ï◊ï◊ó◊ô◊ù",
                displacedLabel: "◊¢◊ß◊ï◊®◊ô◊ù",
                clashesLabel: "◊¢◊ô◊û◊ï◊™◊ô ◊§◊ú◊í◊ô◊ù",
                factionsLabel: "◊§◊ú◊í◊ô◊ù ◊§◊¢◊ô◊ú◊ô◊ù",
                locationsLabel: "◊û◊ô◊ß◊ï◊û◊ô ◊¢◊ô◊û◊ï◊™◊ô◊ù",
                estimated: "◊û◊©◊ï◊¢◊®",
                knowledgeLibraryTitle: "◊°◊§◊®◊ô◊ô◊™ ◊ô◊ì◊¢",
                catSecurity: "◊ë◊ô◊ò◊ó◊ï◊ü ◊ï◊°◊õ◊°◊ï◊ö",
                catEconomic: "◊ô◊¶◊ô◊ë◊ï◊™ ◊õ◊ú◊õ◊ú◊ô◊™ ◊ï◊§◊ô◊†◊†◊°◊ô◊™",
                catGovernance: "◊û◊û◊©◊ú ◊ï◊ì◊ô◊†◊û◊ô◊ß◊î ◊§◊ï◊ú◊ô◊ò◊ô◊™",
                catRegional: "◊î◊©◊§◊¢◊î ◊ê◊ñ◊ï◊®◊ô◊™ ◊ï◊ó◊ô◊¶◊ï◊†◊ô◊™",
                catStructural: "◊û◊ì◊ì◊ô ◊°◊ô◊õ◊ï◊ü ◊û◊ë◊†◊ô◊ô◊ù",
                newsTitle: "◊õ◊ô◊°◊ï◊ô ◊ó◊ì◊©◊ï◊™◊ô",
                tabSyriaDirect: "◊°◊ï◊®◊ô◊î ◊ô◊©◊ô◊®◊ï◊™",
                tabSOHR: "SOHR",
                tabEnglish: "◊ê◊†◊í◊ú◊ô◊™",
                tabHebrew: "◊¢◊ë◊®◊ô◊™",
                tabArabic: "◊¢◊®◊ë◊ô◊™",
                tabFarsi: "◊§◊®◊°◊ô◊™",
                tabReddit: "◊®◊ì◊ô◊ò"
            },
            ar: {
                pageTitle: "üá∏üáæ ŸÖÿ™ÿßÿ®ÿπÿ© ÿßŸÑŸÜÿ≤ÿßÿπ ÿßŸÑÿ≥Ÿàÿ±Ÿä",
                pageSubtitle: "ŸÖÿ±ÿßŸÇÿ®ÿ© ŸÅŸàÿ±Ÿäÿ© ŸÑŸÑÿπŸÜŸÅ ÿßŸÑŸÅÿµÿßÿ¶ŸÑŸä ŸàÿßŸÑŸÜÿ≤Ÿàÿ≠ ÿ®ÿπÿØ ÿßŸÑÿ£ÿ≥ÿØ",
                backLink: "‚Üí ÿßŸÑÿπŸàÿØÿ© ÿ•ŸÑŸâ ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ",
                themeToggle: "ÿßŸÑÿ™ÿ®ÿØŸäŸÑ: ŸÅÿßÿ™ÿ≠ - ÿØÿßŸÉŸÜ",
                deathsLabel: "ÿßŸÑŸàŸÅŸäÿßÿ™ ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿπŸÜŸáÿß",
                displacedLabel: "ÿßŸÑŸÜÿßÿ≤ÿ≠ŸàŸÜ",
                clashesLabel: "ÿßŸÑÿßÿ¥ÿ™ÿ®ÿßŸÉÿßÿ™ ÿßŸÑŸÅÿµÿßÿ¶ŸÑŸäÿ©",
                factionsLabel: "ÿßŸÑŸÅÿµÿßÿ¶ŸÑ ÿßŸÑŸÜÿ¥ÿ∑ÿ©",
                locationsLabel: "ŸÖŸàÿßŸÇÿπ ÿßŸÑÿßÿ¥ÿ™ÿ®ÿßŸÉÿßÿ™",
                estimated: "ÿ™ŸÇÿØŸäÿ±Ÿä",
                knowledgeLibraryTitle: "ŸÖŸÉÿ™ÿ®ÿ© ÿßŸÑŸÖÿπÿ±ŸÅÿ©",
                catSecurity: "ÿßŸÑÿ£ŸÖŸÜ ŸàÿßŸÑŸÜÿ≤ÿßÿπ",
                catEconomic: "ÿßŸÑÿßÿ≥ÿ™ŸÇÿ±ÿßÿ± ÿßŸÑÿßŸÇÿ™ÿµÿßÿØŸä ŸàÿßŸÑŸÖÿßŸÑŸä",
                catGovernance: "ÿßŸÑÿ≠ŸàŸÉŸÖÿ© ŸàÿßŸÑÿØŸäŸÜÿßŸÖŸäŸÉŸäÿßÿ™ ÿßŸÑÿ≥Ÿäÿßÿ≥Ÿäÿ©",
                catRegional: "ÿßŸÑŸÜŸÅŸàÿ∞ ÿßŸÑÿ•ŸÇŸÑŸäŸÖŸä ŸàÿßŸÑÿÆÿßÿ±ÿ¨Ÿä",
                catStructural: "ŸÖÿ§ÿ¥ÿ±ÿßÿ™ ÿßŸÑŸÖÿÆÿßÿ∑ÿ± ÿßŸÑŸáŸäŸÉŸÑŸäÿ©",
                newsTitle: "ÿßŸÑÿ™ÿ∫ÿ∑Ÿäÿ© ÿßŸÑÿ•ÿÆÿ®ÿßÿ±Ÿäÿ©",
                tabSyriaDirect: "ÿ≥Ÿàÿ±Ÿäÿß ŸÖÿ®ÿßÿ¥ÿ±",
                tabSOHR: "SOHR",
                tabEnglish: "ÿßŸÑÿ•ŸÜÿ¨ŸÑŸäÿ≤Ÿäÿ©",
                tabHebrew: "ÿßŸÑÿπÿ®ÿ±Ÿäÿ©",
                tabArabic: "ÿßŸÑÿπÿ±ÿ®Ÿäÿ©",
                tabFarsi: "ÿßŸÑŸÅÿßÿ±ÿ≥Ÿäÿ©",
                tabReddit: "ÿ±ŸäÿØŸäÿ™"
            },
            fa: {
                pageTitle: "üá∏üáæ Ÿæ€å⁄Ø€åÿ±€å ÿØÿ±⁄Ø€åÿ±€å ÿ≥Ÿàÿ±€åŸá",
                pageSubtitle: "ŸÜÿ∏ÿßÿ±ÿ™ ÿ®ŸÑÿßÿØÿ±ŸÜ⁄Ø ÿ®ÿ± ÿÆÿ¥ŸàŸÜÿ™ ÿ¨ŸÜÿßÿ≠‚ÄåŸáÿß Ÿà ÿ¨ÿßÿ®ÿ¨ÿß€å€å Ÿæÿ≥ ÿßÿ≤ ÿßÿ≥ÿØ",
                backLink: "‚Üí ÿ®ÿßÿ≤⁄Øÿ¥ÿ™ ÿ®Ÿá ÿØÿßÿ¥ÿ®Ÿàÿ±ÿØ",
                themeToggle: "ÿ™ÿ∫€å€åÿ±: ÿ±Ÿàÿ¥ŸÜ - ÿ™€åÿ±Ÿá",
                deathsLabel: "⁄©ÿ¥ÿ™Ÿá‚ÄåŸáÿß€å ⁄Øÿ≤ÿßÿ±ÿ¥ ÿ¥ÿØŸá",
                displacedLabel: "ÿ¢Ÿàÿßÿ±⁄ØÿßŸÜ",
                clashesLabel: "ÿØÿ±⁄Ø€åÿ±€å‚ÄåŸáÿß€å ÿ¨ŸÜÿßÿ≠€å",
                factionsLabel: "ÿ¨ŸÜÿßÿ≠‚ÄåŸáÿß€å ŸÅÿπÿßŸÑ",
                locationsLabel: "ŸÖ⁄©ÿßŸÜ‚ÄåŸáÿß€å ÿØÿ±⁄Ø€åÿ±€å",
                estimated: "ÿ™ÿÆŸÖ€åŸÜ€å",
                knowledgeLibraryTitle: "⁄©ÿ™ÿßÿ®ÿÆÿßŸÜŸá ÿØÿßŸÜÿ¥",
                catSecurity: "ÿßŸÖŸÜ€åÿ™ Ÿà ÿØÿ±⁄Ø€åÿ±€å",
                catEconomic: "ÿ´ÿ®ÿßÿ™ ÿßŸÇÿ™ÿµÿßÿØ€å Ÿà ŸÖÿßŸÑ€å",
                catGovernance: "ÿ≠⁄©ŸàŸÖÿ™ Ÿà ŸæŸà€åÿß€å€å‚ÄåŸáÿß€å ÿ≥€åÿßÿ≥€å",
                catRegional: "ŸÜŸÅŸàÿ∞ ŸÖŸÜÿ∑ŸÇŸá‚Äåÿß€å Ÿà ÿÆÿßÿ±ÿ¨€å",
                catStructural: "ÿ¥ÿßÿÆÿµ‚ÄåŸáÿß€å ÿ±€åÿ≥⁄© ÿ≥ÿßÿÆÿ™ÿßÿ±€å",
                newsTitle: "ŸæŸàÿ¥ÿ¥ ÿÆÿ®ÿ±€å",
                tabSyriaDirect: "ÿ≥Ÿàÿ±€åŸá ŸÖÿ≥ÿ™ŸÇ€åŸÖ",
                tabSOHR: "SOHR",
                tabEnglish: "ÿßŸÜ⁄ØŸÑ€åÿ≥€å",
                tabHebrew: "ÿπÿ®ÿ±€å",
                tabArabic: "ÿπÿ±ÿ®€å",
                tabFarsi: "ŸÅÿßÿ±ÿ≥€å",
                tabReddit: "ÿ±ÿØ€åÿ™"
            }
        };

        let currentLang = 'en';

        function switchLanguage(lang) {
            currentLang = lang;
            
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            const isRTL = lang === 'he' || lang === 'ar' || lang === 'fa';
            document.body.setAttribute('dir', isRTL ? 'rtl' : 'ltr');
            
            updateUIText();
        }

        function updateUIText() {
            const t = translations[currentLang];
            
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (t[key]) {
                    element.textContent = t[key];
                }
            });
        }

        // Knowledge Library Toggle Function
        function toggleKnowledgeCard(cardId) {
            const card = document.getElementById(`card-${cardId}`);
            if (card) {
                card.classList.toggle('collapsed');
            }
        }

        async function fetchConflictData() {
            const errorBanner = document.getElementById('errorBanner');
            errorBanner.classList.remove('show');
            
            try {
                const response = await fetch(`${BACKEND_URL}/api/syria-conflicts?days=7`);
                
                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`HTTP ${response.status}: ${errorText.slice(0, 100)}`);
                }
                
                const data = await response.json();
                
                if (!data.success) {
                    throw new Error(data.error || 'API returned success: false');
                }
                
                conflictData = data;
                
                updateMetrics(data);
                updateTabCounts(data);
                showArticles('syria_direct');
                hideLoadingOverlay();
                
            } catch (error) {
                console.error('Error fetching Syria conflict data:', error);
                
                errorBanner.textContent = `‚ö†Ô∏è Error loading data: ${error.message}. Please refresh the page or try again later.`;
                errorBanner.classList.add('show');
                
                document.getElementById('loadingProgress').textContent = 'Error loading data. Please refresh the page.';
                document.getElementById('loadingError').innerHTML = `‚ö†Ô∏è ${error.message}`;
                document.getElementById('loadingError').style.display = 'block';
                
                document.getElementById('articles-container').innerHTML = 
                    `<div class="loading" style="color:#ff6b6b;">Error: ${error.message}</div>`;
            }
        }

        function updateMetrics(data) {
            const cd = data.conflict_data || {};
            const displacement = data.displacement_enhanced || {};
            
            // Update deaths count
            document.getElementById('deathCount').textContent = cd.deaths || 0;
            
            // Update displaced count (use enhanced data if available)
            const totalDisplaced = displacement.total_idps || cd.displaced || 0;
            document.getElementById('displacedCount').textContent = totalDisplaced.toLocaleString();
            
            // Update clashes and factions
            document.getElementById('clashCount').textContent = cd.factional_clashes || 0;
            document.getElementById('factionCount').textContent = cd.num_factions || 0;
            
            // Update displacement breakdown stats
            const breakdown = displacement.idp_breakdown || {};
            document.getElementById('idpCount').textContent = (breakdown.in_camps || 0).toLocaleString();
            document.getElementById('campCount').textContent = (breakdown.with_host_communities || 0).toLocaleString();
            document.getElementById('recentDisplacement').textContent = `+${(breakdown.recent_movements || 0).toLocaleString()}`;
            
            // Update factions list
            if (cd.active_factions && cd.active_factions.length > 0) {
                document.getElementById('factionList').textContent = cd.active_factions.join(', ');
            }
            
            // Update clash locations
            const locList = document.getElementById('locationsList');
            locList.innerHTML = '';
            if (cd.clash_locations) {
                const locations = Object.entries(cd.clash_locations).slice(0, 10);
                locations.forEach(([city, count]) => {
                    const item = document.createElement('div');
                    item.className = 'location-item';
                    item.textContent = `${city.charAt(0).toUpperCase() + city.slice(1)}: ${count} incidents`;
                    locList.appendChild(item);
                });
            }
            
            populateSourceCitations(cd.details || []);
        }
        
        function populateSourceCitations(details) {
            const deathDetails = details.filter(d => d.type === 'deaths').slice(0, 5);
            const displacedDetails = details.filter(d => d.type === 'displaced').slice(0, 5);
            const clashDetails = details.filter(d => d.type === 'clashes').slice(0, 5);
            
            const deathSources = document.getElementById('deathSources');
            deathSources.innerHTML = '';
            if (deathDetails.length > 0) {
                deathSources.innerHTML = '<div class="source-citations-title">Sources:</div>';
                deathDetails.forEach(detail => {
                    const citation = document.createElement('div');
                    citation.className = 'citation-item';
                    citation.innerHTML = `<a href="${detail.url}" target="_blank">${detail.source}: ${detail.count} killed</a>`;
                    deathSources.appendChild(citation);
                });
            }
            
           
            const clashSources = document.getElementById('clashSources');
            clashSources.innerHTML = '';
            if (conflictData && conflictData.articles_syria_direct) {
                const clashArticles = conflictData.articles_syria_direct.slice(0, 3);
                if (clashArticles.length > 0) {
                    clashSources.innerHTML = '<div class="source-citations-title">Recent Reports:</div>';
                    clashArticles.forEach(article => {
                        const citation = document.createElement('div');
                        citation.className = 'citation-item';
                        citation.innerHTML = `<a href="${article.url}" target="_blank">${article.source?.name || 'Source'}</a>`;
                        clashSources.appendChild(citation);
                    });
                }
            }
        }

        function updateTabCounts(data) {
            const tabs = document.querySelectorAll('.language-tabs button');
            const t = translations[currentLang];
            
            const enArticles = (data.articles_en || []).filter(a => a.language === 'en');
            const heArticles = (data.articles_he || []).filter(a => a.language === 'he');
            const arArticles = (data.articles_ar || []).filter(a => a.language === 'ar');
            const faArticles = (data.articles_fa || []).filter(a => a.language === 'fa');
            
            tabs[0].textContent = `${t.tabSyriaDirect} (${(data.articles_syria_direct || []).length})`;
            tabs[1].textContent = `${t.tabSOHR} (${(data.articles_sohr || []).length})`;
            tabs[2].textContent = `${t.tabEnglish} (${enArticles.length})`;
            tabs[3].textContent = `${t.tabHebrew} (${heArticles.length})`;
            tabs[4].textContent = `${t.tabArabic} (${arArticles.length})`;
            tabs[5].textContent = `${t.tabFarsi} (${faArticles.length})`;
            tabs[6].textContent = `${t.tabReddit} (${(data.articles_reddit || []).length})`;
        }

        function showArticles(source, clickEvent) {
            if (!conflictData) return;
            
            document.querySelectorAll('.language-tabs button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            if (clickEvent && clickEvent.target) {
                clickEvent.target.classList.add('active');
            } else {
                const firstButton = document.querySelector('.language-tabs button');
                if (firstButton) firstButton.classList.add('active');
            }
            
            const container = document.getElementById('articles-container');
            container.innerHTML = '';
            
            let articles = [];
            let expectedLang = null;
            
            if (source === 'syria_direct') {
                articles = conflictData.articles_syria_direct || [];
            } else if (source === 'sohr') {
                articles = conflictData.articles_sohr || [];
            } else if (source === 'en') {
                articles = conflictData.articles_en || [];
                expectedLang = 'en';
            } else if (source === 'he') {
                articles = conflictData.articles_he || [];
                expectedLang = 'he';
            } else if (source === 'ar') {
                articles = conflictData.articles_ar || [];
                expectedLang = 'ar';
            } else if (source === 'fa') {
                articles = conflictData.articles_fa || [];
                expectedLang = 'fa';
            } else if (source === 'reddit') {
                articles = conflictData.articles_reddit || [];
            }
            
            if (expectedLang) {
                articles = articles.filter(article => article.language === expectedLang);
            }
            
            if (articles.length === 0) {
                container.innerHTML = '<div class="loading">No articles available in this language.</div>';
                return;
            }
            
            articles.forEach(article => {
                const div = document.createElement('div');
                div.className = 'article';
                div.innerHTML = `
                    <div class="article-title">
                        <a href="${article.url}" target="_blank">${article.title || 'No title'}</a>
                    </div>
                    <div class="article-description">${article.description || ''}</div>
                    <div class="article-meta">
                        <span>${article.source?.name || 'Unknown'}</span>
                        <span>${new Date(article.publishedAt).toLocaleDateString()}</span>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        window.addEventListener('DOMContentLoaded', () => {
            startLoadingProgress();
            fetchConflictData();
            setInterval(fetchConflictData, 30 * 60 * 1000);
        });
    </script>
</body>
</html>
